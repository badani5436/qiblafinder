<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Sunrise & Sunset Finder</title>
<link rel="manifest" href="manifest.json">
<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:linear-gradient(#2b6cb0,#90cdf4);
  color:white;
  text-align:center;
}
.card{
  background:white;
  color:#1a202c;
  max-width:500px;
  margin:30px auto;
  padding:25px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}
h1{font-size:2em;margin-bottom:10px}
button{
  font-size:1.1em;
  padding:12px 20px;
  margin:10px 0;
  border:none;
  border-radius:12px;
  background:#f97316;
  color:white;
  width:100%;
}
input,select{
  font-size:1.1em;
  padding:10px;
  margin:6px 0;
  width:100%;
  border-radius:10px;
  border:1px solid #ccc;
}
.result{
  margin-top:20px;
  font-size:1.3em;
}
.hidden{display:none}
</style>
</head>
<body>
<h1>üåÖ Sunrise & Sunset Finder</h1>
<div class="card">
<button onclick="useGPS()">üìç Use GPS</button>

<select id="mode" onchange="switchMode()">
<option value="decimal">Decimal Degrees</option>
<option value="dms">Degrees ¬∑ Minutes ¬∑ Seconds</option>
</select>

<div id="decimal">
<input id="lat" placeholder="Latitude">
<input id="lon" placeholder="Longitude">
</div>

<div id="dms" class="hidden">
<input id="latd" placeholder="Lat Degrees">
<input id="latm" placeholder="Lat Minutes">
<input id="lats" placeholder="Lat Seconds">
<select id="latdir"><option>N</option><option>S</option></select>
<input id="lond" placeholder="Lon Degrees">
<input id="lonm" placeholder="Lon Minutes">
<input id="lons" placeholder="Lon Seconds">
<select id="londir"><option>E</option><option>W</option></select>
</div>

<button onclick="calculate()">Calculate</button>
<div class="result" id="out"></div>
</div>

<script>
function switchMode(){
 document.getElementById("decimal").classList.toggle("hidden",mode.value==="dms");
 document.getElementById("dms").classList.toggle("hidden",mode.value==="decimal");
}

function useGPS(){
 navigator.geolocation.getCurrentPosition(p=>{
  lat.value=p.coords.latitude.toFixed(6);
  lon.value=p.coords.longitude.toFixed(6);
 });
}

function dmsToDec(d,m,s,dir){
 let v=Number(d)+Number(m)/60+Number(s)/3600;
 return (dir==="S"||dir==="W")?-v:v;
}

function calculate(){
 let latitude,longitude;
 if(mode.value==="decimal"){
  latitude=Number(lat.value);
  longitude=Number(lon.value);
 }else{
  latitude=dmsToDec(latd.value,latm.value,lats.value,latdir.value);
  longitude=dmsToDec(lond.value,lonm.value,lons.value,londir.value);
 }
 if(isNaN(latitude)||isNaN(longitude)){
  out.innerText="Invalid coordinates";
  return;
 }
 let date=new Date();
 let times=sunTimes(latitude,longitude,date);
 out.innerHTML=`üåÖ Sunrise: ${times.sunrise}<br>üåá Sunset: ${times.sunset}`;
}

function sunTimes(lat,lon,d){
 const rad=Math.PI/180;
 const day=Math.floor((d-new Date(d.getFullYear(),0,0))/86400000);
 const lngHour=lon/15;

 function calc(rise){
  const t=day+((rise?6:18)-lngHour)/24;
  const M=0.9856*t-3.289;
  let L=M+1.916*Math.sin(M*rad)+0.02*Math.sin(2*M*rad)+282.634;
  L=(L+360)%360;
  let RA=Math.atan(0.91764*Math.tan(L*rad))/rad;
  RA=(RA+360)%360;
  RA/=15;
  const sinDec=0.39782*Math.sin(L*rad);
  const cosDec=Math.cos(Math.asin(sinDec));
  const cosH=(Math.cos(90.833*rad)-sinDec*Math.sin(lat*rad))/(cosDec*Math.cos(lat*rad));
  let H=rise?360-Math.acos(cosH)/rad:Math.acos(cosH)/rad;
  H/=15;
  const T=H+RA-0.06571*t-6.622;
  let UT=(T-lngHour+24)%24;
  let local=(UT-new Date().getTimezoneOffset()/60+24)%24;
  let h=Math.floor(local),m=Math.floor((local-h)*60);
  return h.toString().padStart(2,"0")+":"+m.toString().padStart(2,"0");
 }
 return {sunrise:calc(true),sunset:calc(false)};
}
</script>
</body>
</html>